<!DOCTYPE html>
<html>
<title>Message</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" type="text/css" href="/abc/css/user.css">
<style type="text/css">
	*{
		font-size: 20px;
		font-family: "Times New Roman", Times, serif; 
	}

</style>
<body>

<div class="w3-sidebar w3-dark-grey w3-bar-block" style="width:15%">
  <h3 class="w3-bar-item">User</h3>
  <a href="/user/viewEvents" class="w3-bar-item w3-button">Events</a>
  <a href="/user/createEvent" class="w3-bar-item w3-button">Create Event</a>
  <a href="/user/myEvent" class="w3-bar-item w3-button">My Event</a>
    <a href="/user/message" class="w3-bar-item w3-button">Message</a>

   <a href="/logout" class="w3-bar-item w3-button">logout</a>
</div>

<div style="margin-left:15%">
<form method="post">

<div class="w3-container w3-light-grey">
<nav class="navbar navbar-light bg-light justify-content-between">
	  <a class="navbar-brand" href="/user/viewEvents">Message</a>
	 
	</nav>  
</div>


<div class="w3-container" align="center">
	<input class="btn btn-dark" type="button" name="click" id="load" value="Chat with UserSupport">
    <div class="container" id="allEvents">    
	  <table class="table table-hover" id="events" >

	  </table>
	  </form>
	  </div>
</div>
</div>
	



<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
<script type="text/javascript">
$( document ).ready(function() {
	
	// GET REQUEST
	$("#load").click(function(event){
        event.preventDefault();
		ajaxGet();
	});
	
	// DO GET
	function ajaxGet(){
    $.ajax({
			type     : "GET",
            url      : "/user/view",
            datatype : 'json',
            
			success: function(result){
				$('#allEvents table').empty();
				$.each(result, function(i, result){
					$('#allEvents #events').append(

				      "<tr>"+
			          "<td rowspan='3' height='150px' width='150px'><img height='150px' src='/abc/img/"+result.image+"'></td>"+
			          "<td colspan='2'>" + result.email + "</td>" +
			          "</tr>"+
			          "<tr>"+
			          "<td>ID:" + result.id + "</td>"+
			          "<td>Name:" + result.name + "</td>" +
			          "</tr>"+
			          "<tr>"+
			          "<td align='right' colspan='2'>"+
			          "<a class='btn btn-success' href='/user/messageToUserSupport/"+result.id+"'>Chat</a>"+
			          "</td>"+
			          "</tr>"

                )
				});
				console.log("Success: ", result);
			},
			error : function(e) {
				$("#load").html("<strong>Error</strong>");
				console.log("ERROR: ", e);
			}
		});	
	}
})
</script>

</html>