<!DOCTYPE html>
<html>
<title>View Events</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" type="text/css" href="/abc/css/user.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<style type="text/css">
	*{
		font-size: 20px;
		font-family: "Times New Roman", Times, serif; 
	}
	
</style>

<body>

<div class="w3-sidebar w3-dark-grey w3-bar-block" style="width:15%">
  <h3 class="w3-bar-item">User</h3>
  <a href="/user/viewEvents" class="w3-bar-item w3-button">Events</a>
  <a href="/user/createEvent" class="w3-bar-item w3-button">Create Event</a>
  <a href="/user/myEvent" class="w3-bar-item w3-button">My Event</a>
    <a href="/user/message" class="w3-bar-item w3-button">Message</a>

   <a href="/logout" class="w3-bar-item w3-button">logout</a>
</div>

<div style="margin-left:15%">

<div class="w3-container w3-light-grey">
<nav class="navbar navbar-light bg-light justify-content-between">
	  <a class="navbar-brand" href="/user/viewEvents">Events</a>
	  <form class="form-inline">
	    <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" id="search">
	  </form>
	</nav>  
</div>



<div class="w3-container">
<div class="container">    
	  <table class="table table-hover" id="events">
	      <tr>
	        <th>Id</th>
	        <th>Event Name</th>
	        <th>Event Picture</th>
	        <th>Description</th>
	        <th>Category Id</th>
	        <th>Goal Amount</th>
	        <th>Goal Date</th>
	        <th>Action</th>
	      </tr>
	    

		  <% for(var i=0; i< eventlist.length; i++ ){ %>
		  <tr id="rows">
		  	<td><%= eventlist[i].id %></td>
		  	<td><%= eventlist[i].eventName %></td>
		  	<td height="128px" width="200px"><img width="200px" height="128px" src="/abc/img/<%= eventlist[i].eventPicture %>"></td>
		  	<td><%= eventlist[i].description %></td>
		  	<td><%= eventlist[i].categoryId %></td>
		  	<td><%= eventlist[i].goalAmount %></td>
		  	<td><%= eventlist[i].goalDate%></td>
		  	<td width="300px">
		  		<a class="btn btn-primary btn-sm" href="/user/donateToEvent/<%=eventlist[i].id%>">Donate</a>
		  		<a class="btn btn-info btn-sm" href="/user/voteToEvent/<%=eventlist[i].id%>">Vote</a>
		  		<a class="btn btn-success btn-sm" href="/user/commentToEvent/<%=eventlist[i].id%>">Comment</a>
		  		<a class="btn btn-danger btn-sm" href="/user/reportToEvent/<%=eventlist[i].id%>">Report</a>
		  	</td>
		  </tr>
		  <% } %>

	  </table>
	</div>
	<a id="dlink"  style="display:none;"></a>
	<input class="btn btn-success" type="button" onclick="tableToExcel('events', 'users', 'allViewEvent.xls')" value="Excel">
</div>

</div>

<script type="text/javascript">
	$(document).ready(function(){
       $('#search').keyup(function(){
            search_table($(this).val());
       });
       function search_table(value){
            $('#events #rows').each(function(){
                 var found = 'false'; 

                 $(this).each(function(){
                      if($(this).text().toLowerCase().indexOf(value.toLowerCase()) >= 0)
                      {
                           found = 'true';
                      }
                 });
                 if(found == 'true')
                 {
                      $(this).show();
                 }
                 else
                 {
                      $(this).hide();
                 }
            });
       }
  });
	  var tableToExcel = (function () {
        var uri = 'data:application/vnd.ms-excel;base64,'
        , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
        , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
        , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
        return function (table, name, filename) {
            if (!table.nodeType) table = document.getElementById(table)
            var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }

            document.getElementById("dlink").href = uri + base64(format(template, ctx));
            document.getElementById("dlink").download = filename;
            document.getElementById("dlink").click();

        }
    })()
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>